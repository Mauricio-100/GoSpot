#!/bin/sh

# GoS v3.0 - Script d'Exécution (non-interactif)
# Ce script est appelé par l'application Node.js principale.

# Couleurs
GREEN() { printf "\033[1;32m%s\033[0m\n" "$1"; }
YELLOW() { printf "\033[1;33m%s\033[0m\n" "$1"; }
RED() { printf "\033[1;31m%s\033[0m\n" "$1"; }

# Logique SERVEUR
run_server() {
    GREEN "--- GoS : Activation du Mode SERVEUR ---"
    YELLOW "ACTION : Assurez-vous d'avoir activé le 'Partage de connexion'."
    
    # ... (collez ici toute la logique de démarrage du serveur sshd) ...
    # Exemple :
    sshd
    SERVER_IP=$(ip a | grep -o '172.20.10.1')
    GREEN "✅ Serveur prêt sur l'IP : $SERVER_IP"
}

# Logique CLIENT
run_client() {
    GREEN "--- GoS : Activation du Mode CLIENT ---"
    YELLOW "ACTION : Assurez-vous d'être connecté au Wi-Fi du serveur.\n"

    # ... (collez ici toute la logique de connexion du client) ...
    # Exemple :
    SERVER_IP=$(arp -a | grep -o '172.20.10.1')
    if [ -z "$SERVER_IP" ]; then
        RED "ERREUR : Serveur introuvable."
        exit 1
    fi
    GREEN "Serveur trouvé ! Connexion à $SERVER_IP..."
    # La logique de recherche/copie/connexion avec la clé SSH va ici
    ssh root@"$SERVER_IP"
}

# Point d'entrée du script
case "$1" in
    serve) run_server ;;
    connect) run_client ;;
    *) RED "Erreur: ce script doit être appelé avec 'serve' ou 'connect'." ;;
esac
